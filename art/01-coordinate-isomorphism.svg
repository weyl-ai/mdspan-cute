<!-- art/01-coordinate-isomorphism.svg -->
<!-- "The Isomorphism" - ι : [0, M) ↔ ∏[0, Mₖ) -->
<!-- The foundation: 1D indices ↔ multi-dimensional coordinates -->
<!-- Rendered with ono-sendai-razorgirl palette @ 2560x1440 -->
<svg width="2560" height="1440" viewBox="0 0 2560 1440" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      @font-face {
        font-family: 'Berkeley Mono';
        src: local('Berkeley Mono'), local('BerkeleyMono-Medium');
      }
      .mono { 
        font-family: 'Berkeley Mono', 'SF Mono', 'Consolas', monospace; 
        font-feature-settings: 'liga' 1, 'calt' 1;
      }
    </style>
    
    <!-- Grid pattern -->
    <pattern id="grid" width="64" height="64" patternUnits="userSpaceOnUse">
      <path d="M 64 0 L 0 0 0 64" fill="none" stroke="#596775" stroke-width="0.5" opacity="0.15"/>
    </pattern>
    
    <!-- Arrow marker -->
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#54aeff"/>
    </marker>
    <marker id="arrow-dim" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#596775"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="2560" height="1440" fill="#111417"/>
  <rect width="2560" height="1440" fill="url(#grid)" opacity="0.4"/>
  
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <!-- TITLE -->
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <g transform="translate(1280, 100)">
    <text x="0" y="0" class="mono" font-size="48" font-weight="600" text-anchor="middle">
      <tspan fill="#80ccff">The Coordinate Isomorphism</tspan>
    </text>
    <text x="0" y="50" class="mono" fill="#596775" font-size="22" text-anchor="middle">
      Definition 2.1 from CuTe Layout Algebra
    </text>
  </g>
  
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <!-- THE THEOREM STATEMENT -->
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <g transform="translate(1280, 220)">
    <text x="0" y="0" class="mono" font-size="32" text-anchor="middle">
      <tspan fill="#b6e3ff">ι</tspan>
      <tspan fill="#596775"> : </tspan>
      <tspan fill="#54aeff">[0, M)</tspan>
      <tspan fill="#80ccff"> ↔ </tspan>
      <tspan fill="#54aeff">[0, M₀)</tspan>
      <tspan fill="#596775"> × </tspan>
      <tspan fill="#54aeff">[0, M₁)</tspan>
      <tspan fill="#596775"> × ⋯ × </tspan>
      <tspan fill="#54aeff">[0, Mₐ)</tspan>
    </text>
    <text x="0" y="50" class="mono" fill="#596775" font-size="18" text-anchor="middle">
      where M = M₀ · M₁ · ⋯ · Mₐ (the product of all extents)
    </text>
  </g>
  
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <!-- LEFT: 1D INDEX SPACE -->
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <g transform="translate(200, 400)">
    <text x="0" y="0" class="mono" fill="#80ccff" font-size="24" font-weight="600">
      // 1D INDEX SPACE
    </text>
    <text x="0" y="35" class="mono" fill="#596775" font-size="16">
      ━━━━━━━━━━━━━━━━━━━━━━━━━━━
    </text>
    
    <!-- Vertical number line -->
    <g transform="translate(180, 80)">
      <!-- The line -->
      <line x1="0" y1="0" x2="0" y2="520" stroke="#596775" stroke-width="2"/>
      
      <!-- Index markers for M=12 (3×4 example) -->
      <g class="mono" font-size="20">
        <circle cx="0" cy="0" r="6" fill="#54aeff"/>
        <text x="-40" y="6" fill="#b6e3ff" text-anchor="end">0</text>
        
        <circle cx="0" cy="43" r="6" fill="#54aeff"/>
        <text x="-40" y="49" fill="#b6e3ff" text-anchor="end">1</text>
        
        <circle cx="0" cy="86" r="6" fill="#54aeff"/>
        <text x="-40" y="92" fill="#b6e3ff" text-anchor="end">2</text>
        
        <circle cx="0" cy="130" r="6" fill="#54aeff"/>
        <text x="-40" y="136" fill="#b6e3ff" text-anchor="end">3</text>
        
        <circle cx="0" cy="173" r="6" fill="#54aeff"/>
        <text x="-40" y="179" fill="#b6e3ff" text-anchor="end">4</text>
        
        <circle cx="0" cy="216" r="6" fill="#54aeff"/>
        <text x="-40" y="222" fill="#b6e3ff" text-anchor="end">5</text>
        
        <circle cx="0" cy="260" r="6" fill="#54aeff"/>
        <text x="-40" y="266" fill="#b6e3ff" text-anchor="end">6</text>
        
        <circle cx="0" cy="303" r="6" fill="#54aeff"/>
        <text x="-40" y="309" fill="#b6e3ff" text-anchor="end">7</text>
        
        <circle cx="0" cy="346" r="6" fill="#54aeff"/>
        <text x="-40" y="352" fill="#b6e3ff" text-anchor="end">8</text>
        
        <circle cx="0" cy="390" r="6" fill="#54aeff"/>
        <text x="-40" y="396" fill="#b6e3ff" text-anchor="end">9</text>
        
        <circle cx="0" cy="433" r="6" fill="#54aeff"/>
        <text x="-40" y="439" fill="#b6e3ff" text-anchor="end">10</text>
        
        <circle cx="0" cy="476" r="6" fill="#54aeff"/>
        <text x="-40" y="482" fill="#b6e3ff" text-anchor="end">11</text>
      </g>
      
      <!-- Extent label -->
      <text x="0" y="560" class="mono" fill="#596775" font-size="18" text-anchor="middle">
        M = 12
      </text>
    </g>
    
    <!-- The equation -->
    <text x="0" y="680" class="mono" fill="#54aeff" font-size="20">
      x ∈ [0, 12)
    </text>
  </g>
  
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <!-- CENTER: THE BIJECTION -->
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <g transform="translate(1280, 500)">
    <!-- decompose arrow -->
    <g transform="translate(-300, 0)">
      <path d="M 0,0 C 100,-50 200,-50 300,0" fill="none" stroke="#80ccff" stroke-width="3" marker-end="url(#arrow)"/>
      <text x="150" y="-70" class="mono" fill="#80ccff" font-size="22" text-anchor="middle" font-weight="600">
        decompose
      </text>
      <text x="150" y="-40" class="mono" fill="#596775" font-size="16" text-anchor="middle">
        x ↦ (x % M₀, ⌊x/M₀⌋ % M₁, ...)
      </text>
    </g>
    
    <!-- recompose arrow -->
    <g transform="translate(-300, 100)">
      <path d="M 300,0 C 200,50 100,50 0,0" fill="none" stroke="#b6e3ff" stroke-width="3" marker-end="url(#arrow)"/>
      <text x="150" y="70" class="mono" fill="#b6e3ff" font-size="22" text-anchor="middle" font-weight="600">
        recompose
      </text>
      <text x="150" y="100" class="mono" fill="#596775" font-size="16" text-anchor="middle">
        (x₀, x₁, ...) ↦ x₀ + x₁·M₀ + x₂·M₀·M₁ + ...
      </text>
    </g>
    
    <!-- The key theorem -->
    <g transform="translate(0, 250)">
      <rect x="-350" y="-35" width="700" height="70" rx="8" fill="#111417" stroke="#54aeff" stroke-width="2"/>
      <text x="0" y="10" class="mono" font-size="24" text-anchor="middle">
        <tspan fill="#b6e3ff">recompose</tspan>
        <tspan fill="#596775"> ∘ </tspan>
        <tspan fill="#80ccff">decompose</tspan>
        <tspan fill="#596775"> = </tspan>
        <tspan fill="#54aeff">id</tspan>
      </text>
    </g>
  </g>
  
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <!-- RIGHT: 2D COORDINATE SPACE -->
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <g transform="translate(1800, 400)">
    <text x="0" y="0" class="mono" fill="#80ccff" font-size="24" font-weight="600">
      // 2D COORDINATE SPACE
    </text>
    <text x="0" y="35" class="mono" fill="#596775" font-size="16">
      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    </text>
    
    <!-- 3×4 grid -->
    <g transform="translate(100, 80)">
      <!-- Grid lines -->
      <g stroke="#596775" stroke-width="1" opacity="0.5">
        <!-- Vertical -->
        <line x1="0" y1="0" x2="0" y2="300"/>
        <line x1="100" y1="0" x2="100" y2="300"/>
        <line x1="200" y1="0" x2="200" y2="300"/>
        <line x1="300" y1="0" x2="300" y2="300"/>
        <!-- Horizontal -->
        <line x1="0" y1="0" x2="300" y2="0"/>
        <line x1="0" y1="100" x2="300" y2="100"/>
        <line x1="0" y1="200" x2="300" y2="200"/>
        <line x1="0" y1="300" x2="300" y2="300"/>
      </g>
      
      <!-- Cell values (1D index) -->
      <g class="mono" font-size="24" fill="#b6e3ff" text-anchor="middle">
        <!-- Row 0 -->
        <text x="50" y="60">0</text>
        <text x="150" y="60">3</text>
        <text x="250" y="60">6</text>
        <!-- Row 1 -->
        <text x="50" y="160">1</text>
        <text x="150" y="160">4</text>
        <text x="250" y="160">7</text>
        <!-- Row 2 -->
        <text x="50" y="260">2</text>
        <text x="150" y="260">5</text>
        <text x="250" y="260">8</text>
      </g>
      
      <!-- Highlight cell (5) = (2, 1) -->
      <rect x="100" y="200" width="100" height="100" fill="#54aeff" opacity="0.3" stroke="#54aeff" stroke-width="3"/>
      
      <!-- Row labels (x₀) -->
      <g class="mono" font-size="16" fill="#596775">
        <text x="-30" y="55">0</text>
        <text x="-30" y="155">1</text>
        <text x="-30" y="255">2</text>
        <text x="-60" y="155" fill="#80ccff">x₀</text>
      </g>
      
      <!-- Column labels (x₁) -->
      <g class="mono" font-size="16" fill="#596775">
        <text x="50" y="340" text-anchor="middle">0</text>
        <text x="150" y="340" text-anchor="middle">1</text>
        <text x="250" y="340" text-anchor="middle">2</text>
        <text x="350" y="340" text-anchor="middle">3</text>
        <text x="150" y="370" text-anchor="middle" fill="#80ccff">x₁</text>
      </g>
      
      <!-- Axis labels -->
      <text x="-80" y="-20" class="mono" fill="#54aeff" font-size="18">M₀ = 3</text>
      <text x="100" y="-20" class="mono" fill="#54aeff" font-size="18">M₁ = 4</text>
    </g>
    
    <!-- The worked example -->
    <text x="0" y="520" class="mono" fill="#596775" font-size="16">
      ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    </text>
    <text x="0" y="560" class="mono" fill="#54aeff" font-size="20">
      Example: x = 5
    </text>
    <text x="0" y="595" class="mono" fill="#596775" font-size="18">
      <tspan>decompose(5) = (5 % 3, 5/3 % 4)</tspan>
    </text>
    <text x="0" y="625" class="mono" fill="#596775" font-size="18">
      <tspan>              = (</tspan>
      <tspan fill="#b6e3ff">2</tspan>
      <tspan>, </tspan>
      <tspan fill="#b6e3ff">1</tspan>
      <tspan>)</tspan>
    </text>
    <text x="0" y="665" class="mono" fill="#596775" font-size="18">
      <tspan>recompose(2, 1) = 2 + 1·3 = </tspan>
      <tspan fill="#b6e3ff">5</tspan>
      <tspan> ✓</tspan>
    </text>
  </g>
  
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <!-- BOTTOM: THE LAYOUT FUNCTION -->
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <g transform="translate(1280, 1150)">
    <text x="0" y="0" class="mono" fill="#80ccff" font-size="24" font-weight="600" text-anchor="middle">
      // THE LAYOUT FUNCTION
    </text>
    <text x="0" y="50" class="mono" font-size="28" text-anchor="middle">
      <tspan fill="#b6e3ff">f</tspan>
      <tspan fill="#596775" font-size="20" baseline-shift="sub">L</tspan>
      <tspan fill="#596775">(x) = </tspan>
      <tspan fill="#54aeff">x₀·d₀ + x₁·d₁ + ⋯ + xₐ·dₐ</tspan>
    </text>
    <text x="0" y="95" class="mono" fill="#596775" font-size="18" text-anchor="middle">
      1D logical index → physical memory offset via coordinate decomposition
    </text>
  </g>
  
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <!-- FOOTER -->
  <!-- ════════════════════════════════════════════════════════════════════════ -->
  <g transform="translate(1280, 1380)">
    <text x="0" y="0" class="mono" font-size="18" text-anchor="middle">
      <tspan fill="#54aeff">//</tspan>
      <tspan fill="#596775" dx="12">razorgirl</tspan>
      <tspan fill="#54aeff" dx="12">//</tspan>
      <tspan fill="#596775" dx="12">CuTe Layout Algebra</tspan>
      <tspan fill="#54aeff" dx="12">//</tspan>
      <tspan fill="#596775" dx="12">01 of 05</tspan>
    </text>
  </g>
</svg>
